# Output interpretation

This page explains how to interpret merged VCF records generated by svx.

Related docs:

- [Usage guide](guide.md)
- [Tuning and defaults](tuning.md)
- [TR containment](tr_containment.md)

## Common support fields

Merged records are written with these INFO fields:

- `SUPP`: number of samples supporting the merged record
- `SUPP_CALLS`: number of input calls merged into the record
- `IDLIST`: IDs of input records merged into the output record

Records are written if `SUPP >= --min-supp` (default `--min-supp 1`) and `SUPP=0` records are written only when `--keep-monomorphic` is set

## Non-BND records (`INS/DEL/INV/DUP/CNV`)

For non-BND merged groups, svx selects a single representative *input* record to populate the core VCF fields:

- `CHROM`, `POS`, `ID`, `REF`, `ALT`
- `FORMAT` is assembled per output sample from merged group membership (`GT` is always written, missing placeholders are used for unsupported samples)

Because `REF/ALT` are anchored at `POS`, the output `POS` is the representative member’s breakpoint. Merge-level summaries are added as INFO fields:

- `CIPOS`: confidence interval around `POS` (two integer offsets: `lo,hi`)
- `END`: merged end coordinate for interval-like classes
- `CIEND`: confidence interval around `END` for interval-like classes (two integer offsets: `lo,hi`)
- `TR_CONTAINED`: TR ID assigned to the merged record when it is considered TR-contained (see [TR containment](tr_containment.md))

`SVLEN` is written as a merged estimate derived from the merged breakpoints, not as a passthrough from any one member.

Coordinate conventions: `POS` and `END` are 1-based VCF coordinates. For interval-like SVs, svx follows the common SV convention that `abs(SVLEN) ≈ END - POS` (not `END - POS + 1`).

### Deriving summary metrics from `CIPOS` / `CIEND`

Svx writes `CIPOS/CIEND` as integer-rounded base-pair offsets relative to the reported anchors (`POS` and `END`). In svx output, you can interpret these offsets as the lower and upper bounds of an approximate two-sided 95% interval around the true anchored coordinate (normal approximation with `z = 1.96`). Because the bounds are stored as integers in VCF, derived values are approximate (up to about ±0.5 bp rounding at each bound).

For non-BND records the anchors are:

- `POS` for `CIPOS`
- `END` for `CIEND` (interval-like classes only)

Given `CIPOS = [lo, hi]` and output `POS` (1-based):

- `start_lo = POS + lo`
- `start_hi = POS + hi`
- `start_mean_est = (start_lo + start_hi) / 2`
- `start_sigma_est = (start_hi - start_lo) / (2 * 1.96)`
- `start_variance_est = start_sigma_est^2`

Given `CIEND = [lo, hi]` and output `END` (1-based):

- `end_lo = END + lo`
- `end_hi = END + hi`
- `end_mean_est = (end_lo + end_hi) / 2`
- `end_sigma_est = (end_hi - end_lo) / (2 * 1.96)`
- `end_variance_est = end_sigma_est^2`

For interval-like classes, an estimated merged length mean can be derived from the anchor means:

- `svlen_mean_est = abs(end_mean_est - start_mean_est)`

#### Worked examples

Example 1 (`SVTYPE=INS`):

- INFO: `SVTYPE=INS;SVLEN=230;CIPOS=-6,8`
- `POS=373984`, `CIPOS=[-6,8]`
- `start_lo = 373984 + (-6) = 373978`
- `start_hi = 373984 + 8 = 373992`
- `start_mean_est = (373978 + 373992) / 2 = 373985.0`
- `start_sigma_est = (373992 - 373978) / (2 * 1.96) = 3.571429`
- `start_variance_est = 3.571429^2 = 12.755102`

Example 2 (`SVTYPE=DEL`):

- INFO: `SVTYPE=DEL;SVLEN=-44;CIPOS=-7,5;END=41824812;CIEND=-8,6`
- `POS=41824768`, `CIPOS=[-7,5]`, `END=41824812`, `CIEND=[-8,6]`
- `start_lo = 41824768 + (-7) = 41824761`
- `start_hi = 41824768 + 5 = 41824773`
- `start_mean_est = (41824761 + 41824773) / 2 = 41824767.0`
- `start_sigma_est = (41824773 - 41824761) / (2 * 1.96) = 3.061224`
- `start_variance_est = 3.061224^2 = 9.371095`
- `end_lo = 41824812 + (-8) = 41824804`
- `end_hi = 41824812 + 6 = 41824818`
- `end_mean_est = (41824804 + 41824818) / 2 = 41824811.0`
- `end_sigma_est = (41824818 - 41824804) / (2 * 1.96) = 3.571429`
- `end_variance_est = 3.571429^2 = 12.755102`
- `svlen_mean_est = -abs(41824811.0 - 41824767.0) = -44.0` (matches `SVLEN`)

Example 3 (`SVTYPE=CNV`):

- INFO: `SVTYPE=CNV;SVLEN=5500;CIPOS=0,0;END=125183500;CIEND=-980,980`
- `POS=125178000`, `CIPOS=[0,0]`, `END=125183500`, `CIEND=[-980,980]`
- `start_lo = 125178000 + 0 = 125178000`
- `start_hi = 125178000 + 0 = 125178000`
- `start_mean_est = (125178000 + 125178000) / 2 = 125178000.0`
- `start_sigma_est = (125178000 - 125178000) / (2 * 1.96) = 0.0`
- `start_variance_est = 0.0^2 = 0.0`
- `end_lo = 125183500 + (-980) = 125182520`
- `end_hi = 125183500 + 980 = 125184480`
- `end_mean_est = (125182520 + 125184480) / 2 = 125183500.0`
- `end_sigma_est = (125184480 - 125182520) / (2 * 1.96) = 500.0`
- `end_variance_est = 500.0^2 = 250000.0`
- `svlen_mean_est = +abs(125183500.0 - 125178000.0) = 5500.0` (matches `SVLEN`)

For CNV-mode merging (`--svtype CNV`), svx writes canonical CNV records, where all merged CNV outputs have `SVTYPE=CNV` with `ALT=<CNV>`.

## Breakends (BND) / translocations

Breakends (`SVTYPE=BND`) are handled as paired breakends representing one event. During merging, breakends are paired per input VCF using `INFO/MATEID`, and merging happens at the event level, not single-breakend level. Here orientation is part of event identity and missing mates are dropped (a warning will be output if this happens). In the output, each merged event is written as two `SVTYPE=BND` records with the same `INFO/EVENT` value, a reciprocal `INFO/MATEID`, IDs that are derived as `<event>_A` and `<event>_B`, and rounded merged positions for each breakend. Each BND output record also includes:

- `CHR2`: mate contig
- `STRANDS`: breakend orientation corresponding to ALT bracket form
- `CIPOS`: confidence interval around that breakend's `POS` (2-integer offset pair)

### Interpreting `CIPOS` for BND

For BND, `CIPOS` is per breakend (there is no interval-style `END/CIEND`):

- `breakend_lo = POS + lo`
- `breakend_hi = POS + hi`
- `breakend_mean_est = (breakend_lo + breakend_hi) / 2`
- `breakend_sigma_est = (breakend_hi - breakend_lo) / (2 * 1.96)`
- `breakend_variance_est = breakend_sigma_est^2`

Example `SVTYPE=BND`:

- INFO: `SVTYPE=BND;...;CIPOS=-4,3;...`
- `POS=204547`, `CIPOS=[-4,3]`
- `breakend_lo = 204547 + (-4) = 204543`
- `breakend_hi = 204547 + 3 = 204550`
- `breakend_mean_est = (204543 + 204550) / 2 = 204546.5`
- `breakend_sigma_est = (204550 - 204543) / (2 * 1.96) = 1.785714`
- `breakend_variance_est = 1.785714^2 = 3.188776`

Inversion-associated BND metadata is preserved conservatively. If all merged members of a BND group carry compatible inversion metadata, svx keeps inversion linkage (`INFO/EVENT`), outputting `INFO/EVENTTYPE=INV`, and marks both output breakends with `FILTER=InvBreakpoint`. If group members disagree or only a subset carries inversion metadata, svx falls back to standard BND output (synthesized `EVENT`, no `EVENTTYPE`, no `InvBreakpoint` filter).
